(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-16600b68"],{"0c3e":function(t,e,a){},"333d":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[a("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)},n=[];a("c5f6");Math.easeInOutQuad=function(t,e,a,i){return t/=i/2,t<1?a/2*t*t+e:(t--,-a/2*(t*(t-2)-1)+e)};var s=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function r(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(t,e,a){var i=o(),n=t-i,l=20,p=0;e="undefined"===typeof e?500:e;var c=function t(){p+=l;var o=Math.easeInOutQuad(p,i,n,e);r(o),p<e?s(t):a&&"function"===typeof a&&a()};c()}var p={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},page_size:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.page_size},set:function(t){this.$emit("update:page_size",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,page_size:t}),this.autoScroll&&l(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,page_size:this.pageSize}),this.autoScroll&&l(0,800)}}},c=p,u=(a("36ff"),a("2877")),d=Object(u["a"])(c,i,n,!1,null,"16564f64",null);e["a"]=d.exports},"36ff":function(t,e,a){"use strict";var i=a("0c3e"),n=a.n(i);n.a},"383f":function(t,e,a){"use strict";a.d(e,"m",(function(){return n})),a.d(e,"q",(function(){return s})),a.d(e,"e",(function(){return r})),a.d(e,"a",(function(){return o})),a.d(e,"d",(function(){return l})),a.d(e,"b",(function(){return p})),a.d(e,"s",(function(){return c})),a.d(e,"w",(function(){return u})),a.d(e,"r",(function(){return d})),a.d(e,"y",(function(){return _})),a.d(e,"z",(function(){return m})),a.d(e,"x",(function(){return f})),a.d(e,"o",(function(){return g})),a.d(e,"A",(function(){return h})),a.d(e,"c",(function(){return v})),a.d(e,"p",(function(){return b})),a.d(e,"n",(function(){return y})),a.d(e,"t",(function(){return w})),a.d(e,"v",(function(){return D})),a.d(e,"u",(function(){return x})),a.d(e,"j",(function(){return k})),a.d(e,"f",(function(){return O})),a.d(e,"k",(function(){return T})),a.d(e,"g",(function(){return S})),a.d(e,"i",(function(){return j})),a.d(e,"h",(function(){return L})),a.d(e,"l",(function(){return $}));var i=a("b775");function n(t){return Object(i["a"])({url:"/saltstack/salt-minion/1/",method:"get",params:t})}function s(t){return Object(i["a"])({url:"/saltstack/salt-key/",method:"get",params:t})}function r(){return Object(i["a"])({url:"/saltstack/salt-key/",method:"post",data:{salt_key_tag:"global_flush_salt_key"}})}function o(t){return Object(i["a"])({url:"/saltstack/salt-key-opt/accept/",method:"post",data:{salt_key_tag:"accept_salt_key",minion_id:t}})}function l(t){return Object(i["a"])({url:"/saltstack/salt-key-opt/delete/",method:"post",data:{salt_key_tag:"delete_salt_key",minion_id:t}})}function p(t){return Object(i["a"])({url:"/saltstack/salt-key-opt/del-denied/",method:"post",data:{salt_key_tag:"delete_denied_salt_key",minion_id:t}})}function c(t){return Object(i["a"])({url:"/saltstack/salt-key-opt/reject/",method:"post",data:{salt_key_tag:"reject_salt_key",minion_id:t}})}function u(t){return Object(i["a"])({url:"/saltstack/salt-key/"+t+"/",method:"get"})}function d(t){return Object(i["a"])({url:"/saltstack/salt-minion/",method:"get",params:t})}function _(){return Object(i["a"])({url:"/saltstack/salt-minion/",method:"post",data:{salt_minion_tag:"global_update_salt_minion_list"}})}function m(){return Object(i["a"])({url:"/saltstack/salt-minion-opt/status-update/",method:"post",data:{salt_minion_tag:"global_update_salt_minion_status"}})}function f(t){return Object(i["a"])({url:"/saltstack/salt-minion-opt/update/",method:"post",data:{salt_minion_tag:"update_salt_minion",minion_id:t}})}function g(t){return Object(i["a"])({url:"/saltstack/salt-cmd/",method:"get",params:t})}function h(t){return Object(i["a"])({url:"/saltstack/salt-cmd/",method:"post",data:{salt_cmd_tag:"collection_info",collection_style:t.collection_style,minions:t.minions}})}function v(){return Object(i["a"])({url:"/saltstack/salt-cmd-opt/delete/",method:"post",data:{salt_cmd_tag:"salt_cmd_delete"}})}function b(t){return Object(i["a"])({url:"/saltstack/salt-cmd-opt/get-module/",method:"get",params:{salt_cmd_type:t}})}function y(t,e){return Object(i["a"])({url:"/saltstack/salt-cmd-opt/get-cmd/",method:"get",params:{salt_cmd_type:t,salt_cmd_module:e}})}function w(t){return Object(i["a"])({url:"/saltstack/salt-exe/",method:"post",data:t})}function D(t){return Object(i["a"])({url:"/saltstack/salt-tool/job-search/status/",method:"post",data:t})}function x(t){return Object(i["a"])({url:"/saltstack/salt-tool/job-search/result/",method:"post",data:t})}function k(t){return Object(i["a"])({url:"/saltstack/file-manage/file-tree/",method:"post",data:t})}function O(t){return Object(i["a"])({url:"/saltstack/file-manage/file-content/",method:"post",data:t})}function T(t){return Object(i["a"])({url:"/saltstack/file-manage/file-update/",method:"post",data:t})}function S(t){return Object(i["a"])({url:"/saltstack/file-manage/file-create/",method:"post",data:t})}function j(t){return Object(i["a"])({url:"/saltstack/file-manage/file-rename/",method:"post",data:t})}function L(t){return Object(i["a"])({url:"/saltstack/file-manage/file-delete/",method:"post",data:t})}function $(t){return Object(i["a"])({url:"/saltstack/file-manage/file-upload/",method:"post",data:t})}},"5c83":function(t,e,a){"use strict";a("a481"),a("6762"),a("2fdb");var i={bind:function(t,e,a){var i=t.querySelector(".el-dialog__header"),n=t.querySelector(".el-dialog");i.style.cssText+=";cursor:move;",n.style.cssText+=";top:0px;";var s=function(){return window.document.currentStyle?function(t,e){return t.currentStyle[e]}:function(t,e){return getComputedStyle(t,!1)[e]}}();i.onmousedown=function(t){var e=t.clientX-i.offsetLeft,r=t.clientY-i.offsetTop,o=n.offsetWidth,l=n.offsetHeight,p=document.body.clientWidth,c=document.body.clientHeight,u=n.offsetLeft,d=p-n.offsetLeft-o,_=n.offsetTop,m=c-n.offsetTop-l,f=s(n,"left"),g=s(n,"top");f.includes("%")?(f=+document.body.clientWidth*(+f.replace(/\%/g,"")/100),g=+document.body.clientHeight*(+g.replace(/\%/g,"")/100)):(f=+f.replace(/\px/g,""),g=+g.replace(/\px/g,"")),document.onmousemove=function(t){var i=t.clientX-e,s=t.clientY-r;-i>u?i=-u:i>d&&(i=d),-s>_?s=-_:s>m&&(s=m),n.style.cssText+=";left:".concat(i+f,"px;top:").concat(s+g,"px;"),a.child.$emit("dragDialog")},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null}}}},n=function(t){t.directive("el-drag-dialog",i)};window.Vue&&(window["el-drag-dialog"]=i,Vue.use(n)),i.install=n;e["a"]=i},6724:function(t,e,a){"use strict";a("8d41");var i="@@wavesContext";function n(t,e){function a(a){var i=Object.assign({},e.value),n=Object.assign({ele:t,type:"hit",color:"rgba(0, 0, 0, 0.15)"},i),s=n.ele;if(s){s.style.position="relative",s.style.overflow="hidden";var r=s.getBoundingClientRect(),o=s.querySelector(".waves-ripple");switch(o?o.className="waves-ripple":(o=document.createElement("span"),o.className="waves-ripple",o.style.height=o.style.width=Math.max(r.width,r.height)+"px",s.appendChild(o)),n.type){case"center":o.style.top=r.height/2-o.offsetHeight/2+"px",o.style.left=r.width/2-o.offsetWidth/2+"px";break;default:o.style.top=(a.pageY-r.top-o.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",o.style.left=(a.pageX-r.left-o.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return o.style.backgroundColor=n.color,o.className="waves-ripple z-active",!1}}return t[i]?t[i].removeHandle=a:t[i]={removeHandle:a},a}var s={bind:function(t,e){t.addEventListener("click",n(t,e),!1)},update:function(t,e){t.removeEventListener("click",t[i].removeHandle,!1),t.addEventListener("click",n(t,e),!1)},unbind:function(t){t.removeEventListener("click",t[i].removeHandle,!1),t[i]=null,delete t[i]}},r=function(t){t.directive("waves",s)};window.Vue&&(window.waves=s,Vue.use(r)),s.install=r;e["a"]=s},"8d41":function(t,e,a){},"9bba":function(t,e,a){},ce3a:function(t,e,a){"use strict";var i=a("9bba"),n=a.n(i);n.a},dcd2:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.allLoading,expression:"allLoading"}],staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-row",[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",size:"small"},on:{click:t.handAddReleaseDailog}},[t._v("新增应用")]),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"success",size:"small"},on:{click:t.handGoReleaseList}},[t._v("批量发布")]),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",size:"small",loading:t.listLoading},on:{click:t.getList}},[t._v("刷新")]),t._v(" "),a("div",{staticStyle:{float:"right"}},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"应用名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleFilter(e)}},model:{value:t.listQuery.app_name,callback:function(e){t.$set(t.listQuery,"app_name",e)},expression:"listQuery.app_name"}}),t._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"Minion ID"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleFilter(e)}},model:{value:t.listQuery.minion_id,callback:function(e){t.$set(t.listQuery,"minion_id",e)},expression:"listQuery.minion_id"}}),t._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"svn/git地址"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleFilter(e)}},model:{value:t.listQuery.app_url,callback:function(e){t.$set(t.listQuery,"app_url",e)},expression:"listQuery.app_url"}}),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("搜索")])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,staticClass:"release_table",staticStyle:{width:"100%"},attrs:{data:t.data_list,size:"medium",border:"",fit:"","highlight-current-row":""},on:{"sort-change":t.sortChange,"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{label:"应用名称",prop:"app_name",sortable:"custom",align:"center",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.app_name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"Minion_id",prop:"minion_list",sortable:"custom",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.minion_list))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作步骤",align:"center","min-width":"350"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(JSON.parse(e.row.operation_list),(function(i,n){return a("span",{key:n},[a("span",{staticClass:"link-type",on:{click:function(a){return t.handleSingleRelease(e.row,i)}}},[t._v(t._s(i))]),n!=JSON.parse(e.row.operation_list).length-1?a("span",[t._v(">>")]):t._e()])}))}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return t.handGoRelease(e.row)}}},[t._v("发布")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handAppLogDailog(e.row)}}},[t._v("日志")]),t._v(" "),a("el-dropdown",{staticStyle:{"margin-left":"10px"},attrs:{trigger:"click",placement:"bottom-start"}},[a("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("\n            更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(a){return t.handAppInfoDailog(e.row)}}},[t._v("详情")]),t._v(" "),a("el-dropdown-item",{nativeOn:{click:function(a){return t.handUpdateReleaseDailog(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-dropdown-item",{nativeOn:{click:function(a){return t.handDeleteAppDailog(e.row)}}},[t._v("删除")]),t._v(" "),a("el-dropdown-item",[t._v("备份")]),t._v(" "),a("el-dropdown-item",[t._v("还原")])],1)],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"发布状态",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["发布成功"===e.row.release_status?a("span",{staticClass:"status_success"},[t._v("发布成功")]):"发布中"===e.row.release_status?a("span",{staticClass:"status_loading"},[t._v("发布中"),a("span",{staticClass:"dot-ani"})]):"发布失败"===e.row.release_status?a("span",{staticClass:"status_error"},[t._v("发布失败")]):"空闲"===e.row.release_status?a("span",{staticClass:"status_info"},[t._v("空闲")]):t._e()]}}])})],1),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,page_size:t.listQuery.page_size},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:page_size":function(e){return t.$set(t.listQuery,"page_size",e)},pagination:t.getList}}),t._v(" "),a("el-dialog",{staticClass:"AppForm",attrs:{title:t.dialogAppFormTitle,width:"1220px",visible:t.dialogAppFormVisible,"close-on-press-escape":!1,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogAppFormVisible=e}}},[a("div",{staticClass:"overflow_set"},[a("el-form",{ref:"appDataForm",staticStyle:{width:"1175px",margin:"0"},attrs:{rules:t.rules,model:t.appData,"label-position":"right","label-width":"130px"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"应用名称：",prop:"app_name",error:t.app_name_error}},[a("el-input",{ref:"app_name_focus",staticStyle:{width:"260px"},model:{value:t.appData.app_name,callback:function(e){t.$set(t.appData,"app_name",e)},expression:"appData.app_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"系统类型：",prop:"sys_type"}},[a("el-radio-group",{on:{change:t.getIdList},model:{value:t.appData.sys_type,callback:function(e){t.$set(t.appData,"sys_type",e)},expression:"appData.sys_type"}},[a("el-radio",{attrs:{label:"linux"}},[t._v("Linux")]),t._v(" "),a("el-radio",{attrs:{label:"windows"}},[t._v("Windows")])],1)],1),t._v(" "),a("el-form-item",{staticClass:"is-required",attrs:{label:"Minion id：",prop:"minion_list",error:t.minion_transfer_error}},[a("el-transfer",{ref:"dataTransfer",attrs:{filterable:"","filter-placeholder":"搜索Minion ID",titles:["Minion ID选择","已选Minion ID"],data:t.minion_list,"target-order":"push"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.option;return a("span",{},[a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:i.label,placement:"right"}},[a("span",[t._v(t._s(i.label))])])],1)}}]),model:{value:t.appData.minion_list,callback:function(e){t.$set(t.appData,"minion_list",e)},expression:"appData.minion_list"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"应用目录：",prop:"app_path"}},[a("el-input",{staticStyle:{width:"440px"},model:{value:t.appData.app_path,callback:function(e){t.$set(t.appData,"app_path",e)},expression:"appData.app_path"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"linux"==t.appData.sys_type,expression:"appData.sys_type == 'linux'"}],staticClass:"is-required",attrs:{label:"目录属主：",prop:"app_path_owner"}},[a("el-input",{staticStyle:{width:"140px"},model:{value:t.appData.app_path_owner,callback:function(e){t.$set(t.appData,"app_path_owner",e)},expression:"appData.app_path_owner"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("SVN更新"),expression:"appData.operation_list.indexOf('SVN更新') != -1"}],staticClass:"is-required",attrs:{label:"svn地址：",prop:"app_svn_url"}},[a("el-input",{staticStyle:{width:"440px"},model:{value:t.appData.app_svn_url,callback:function(e){t.$set(t.appData,"app_svn_url",e)},expression:"appData.app_svn_url"}})],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:11}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("SVN更新"),expression:"appData.operation_list.indexOf('SVN更新') != -1"}],staticClass:"is-required",attrs:{label:"svn账户：",prop:"app_svn_user"}},[a("el-input",{model:{value:t.appData.app_svn_user,callback:function(e){t.$set(t.appData,"app_svn_user",e)},expression:"appData.app_svn_user"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("SVN更新"),expression:"appData.operation_list.indexOf('SVN更新') != -1"}],staticClass:"is-required",attrs:{label:"svn密码：",prop:"app_svn_password","label-width":"90px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.appData.app_svn_password,callback:function(e){t.$set(t.appData,"app_svn_password",e)},expression:"appData.app_svn_password"}})],1)],1)],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("GIT更新"),expression:"appData.operation_list.indexOf('GIT更新') != -1"}],staticClass:"is-required",attrs:{label:"git地址：",prop:"app_git_url"}},[a("el-input",{staticStyle:{width:"440px"},model:{value:t.appData.app_git_url,callback:function(e){t.$set(t.appData,"app_git_url",e)},expression:"appData.app_git_url"}})],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:11}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("GIT更新"),expression:"appData.operation_list.indexOf('GIT更新') != -1"}],staticClass:"is-required",attrs:{label:"git账户：",prop:"app_git_user"}},[a("el-input",{model:{value:t.appData.app_git_user,callback:function(e){t.$set(t.appData,"app_git_user",e)},expression:"appData.app_git_user"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("GIT更新"),expression:"appData.operation_list.indexOf('GIT更新') != -1"}],staticClass:"is-required",attrs:{label:"git密码：",prop:"app_git_password","label-width":"90px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.appData.app_git_password,callback:function(e){t.$set(t.appData,"app_git_password",e)},expression:"appData.app_git_password"}})],1)],1)],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("GIT更新"),expression:"appData.operation_list.indexOf('GIT更新') != -1"}],staticClass:"is-required",attrs:{label:"git分支：",prop:"app_git_branch"}},[a("el-input",{staticStyle:{width:"240px"},model:{value:t.appData.app_git_branch,callback:function(e){t.$set(t.appData,"app_git_branch",e)},expression:"appData.app_git_branch"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"应用发布详情"==t.dialogAppFormTitle,expression:"dialogAppFormTitle=='应用发布详情'"}],attrs:{label:"svn/git检出目录：",prop:"co_path"}},[a("el-input",{model:{value:t.appData.co_path,callback:function(e){t.$set(t.appData,"co_path",e)},expression:"appData.co_path"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"应用发布详情"==t.dialogAppFormTitle,expression:"dialogAppFormTitle=='应用发布详情'"}],attrs:{label:"检出状态：",prop:"co_status"}},[a("el-input",{model:{value:t.appData.co_status,callback:function(e){t.$set(t.appData,"co_status",e)},expression:"appData.co_status"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"多主机执行顺序：","label-width":"140px",prop:"execution_style"}},[a("el-radio-group",{model:{value:t.appData.execution_style,callback:function(e){t.$set(t.appData,"execution_style",e)},expression:"appData.execution_style"}},[a("el-radio",{attrs:{label:"serial"}},[t._v("顺序")]),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"开发中...",placement:"top-start"}},[a("el-radio",{attrs:{label:"parallel",disabled:""}},[t._v("并行")])],1)],1)],1),t._v(" "),a("el-form-item",{staticClass:"operationTransferClass is-required",attrs:{label:"操作选择：",prop:"operation_list",error:t.operation_transfer_error}},[a("el-transfer",{ref:"operationTransfer",attrs:{titles:["可选操作","选中操作 有序"],data:t.operation_list,"target-order":"push"},model:{value:t.appData.operation_list,callback:function(e){t.$set(t.appData,"operation_list",e)},expression:"appData.operation_list"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("同步文件"),expression:"appData.operation_list.indexOf('同步文件') != -1"}],staticClass:"is-required",attrs:{label:"是否对比差异:",prop:"sync_file_check_diff"}},[a("el-radio-group",{model:{value:t.appData.sync_file_check_diff,callback:function(e){t.$set(t.appData,"sync_file_check_diff",e)},expression:"appData.sync_file_check_diff"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"应用目录中有同步目录里不存在的文件将被删除，如临时文件、日志文件等",placement:"top-start"}},[a("el-radio",{attrs:{label:"check_file"}},[t._v("比对差异")])],1),t._v(" "),a("el-radio",{attrs:{label:"not_check_file"}},[t._v("不比对差异")])],1)],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("同步文件"),expression:"appData.operation_list.indexOf('同步文件') != -1"}],staticClass:"is-required",attrs:{label:"同步方法:",prop:"sync_file_method"}},[a("el-radio-group",{model:{value:t.appData.sync_file_method,callback:function(e){t.$set(t.appData,"sync_file_method",e)},expression:"appData.sync_file_method"}},[a("el-radio",{attrs:{label:"rsync"}},[t._v("rsync")]),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"不建议使用saltstack的文件服务，性能很差",placement:"top-start"}},[a("el-radio",{attrs:{label:"salt"}},[t._v("salt")])],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:11}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("同步文件")&&"rsync"==t.appData.sync_file_method,expression:"appData.operation_list.indexOf('同步文件') != -1 && appData.sync_file_method=='rsync'"}],staticClass:"is-required",attrs:{label:"rsync_ip：",prop:"rsync_ip"}},[a("el-input",{model:{value:t.appData.rsync_ip,callback:function(e){t.$set(t.appData,"rsync_ip",e)},expression:"appData.rsync_ip"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("同步文件")&&"rsync"==t.appData.sync_file_method,expression:"appData.operation_list.indexOf('同步文件') != -1 && appData.sync_file_method=='rsync'"}],staticClass:"is-required",attrs:{label:"rsync_port:",prop:"rsync_port","label-width":"100px"}},[a("el-input",{model:{value:t.appData.rsync_port,callback:function(e){t.$set(t.appData,"rsync_port",e)},expression:"appData.rsync_port"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("应用停止"),expression:"appData.operation_list.indexOf('应用停止') != -1"}],staticClass:"app_stop is-required",attrs:{label:"应用停止方式：",prop:"app_stop_style"}},[a("el-radio-group",{model:{value:t.appData.app_stop_style,callback:function(e){t.$set(t.appData,"app_stop_style",e)},expression:"appData.app_stop_style"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-radio",{attrs:{label:"停止服务名"}},[t._v("停止服务名")])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-radio",{attrs:{label:"停止命令"}},[t._v("停止命令")])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-radio",{attrs:{label:"任务计划停止"}},[t._v("任务计划")])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-radio",{attrs:{label:"supervisor_stop"}},[t._v("supervisor")])],1)],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-tooltip",{attrs:{effect:"dark",content:"windows在任务管理器中的进程里可以查看映像名称和命令行，linux用ss -anp查看映像名称ps -ef查看命令行",placement:"top"}},[a("el-radio",{attrs:{label:"映像名称和命令行"}},[t._v("映像名称和命令行")])],1)],1)],1)],1)],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("应用停止"),expression:"appData.operation_list.indexOf('应用停止') != -1"}],staticClass:"is-required",attrs:{label:"应用停止命令：",prop:"app_stop_cmd"}},[a("el-col",{attrs:{span:22}},[a("el-input",{staticStyle:{width:"440px"},attrs:{placeholder:"映像名称和命令行"!=t.appData.app_stop_style?t.appData.app_stop_style:"格式为：映像名称 | 命令行"},model:{value:t.appData.app_stop_cmd,callback:function(e){t.$set(t.appData,"app_stop_cmd",e)},expression:"appData.app_stop_cmd"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("应用启动"),expression:"appData.operation_list.indexOf('应用启动') != -1"}],staticClass:"is-required",attrs:{label:"应用启动方式：",prop:"app_start_style"}},[a("el-radio-group",{model:{value:t.appData.app_start_style,callback:function(e){t.$set(t.appData,"app_start_style",e)},expression:"appData.app_start_style"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-radio",{attrs:{label:"启动服务名"}},[t._v("启动服务名")])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-radio",{attrs:{label:"启动命令"}},[t._v("启动命令")])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-radio",{attrs:{label:"任务计划启动"}},[t._v("任务计划")])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-radio",{attrs:{label:"supervisor_start"}},[t._v("supervisor")])],1)],1)],1)],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("应用启动"),expression:"appData.operation_list.indexOf('应用启动') != -1"}],staticClass:"is-required",attrs:{label:"应用启动命令：",prop:"app_start_cmd"}},[a("el-col",{attrs:{span:22}},[a("el-input",{staticStyle:{width:"440px"},attrs:{placeholder:t.appData.app_start_style},model:{value:t.appData.app_start_cmd,callback:function(e){t.$set(t.appData,"app_start_cmd",e)},expression:"appData.app_start_cmd"}})],1)],1)],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("执行命令1"),expression:"appData.operation_list.indexOf('执行命令1') != -1"}],staticClass:"is-required",attrs:{label:"执行命令1：",prop:"cmd1"}},[a("el-input",{staticStyle:{width:"440px"},model:{value:t.appData.cmd1,callback:function(e){t.$set(t.appData,"cmd1",e)},expression:"appData.cmd1"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:-1!=t.appData.operation_list.indexOf("执行命令2"),expression:"appData.operation_list.indexOf('执行命令2') != -1"}],staticClass:"is-required",attrs:{label:"执行命令2：",prop:"cmd2"}},[a("el-input",{staticStyle:{width:"440px"},model:{value:t.appData.cmd2,callback:function(e){t.$set(t.appData,"cmd2",e)},expression:"appData.cmd2"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"应用备份目录：",prop:"app_backup_path"}},[a("el-input",{staticStyle:{width:"440px"},model:{value:t.appData.app_backup_path,callback:function(e){t.$set(t.appData,"app_backup_path",e)},expression:"appData.app_backup_path"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注：",prop:"description"}},[a("el-input",{staticStyle:{width:"440px"},model:{value:t.appData.description,callback:function(e){t.$set(t.appData,"description",e)},expression:"appData.description"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"应用发布详情"==t.dialogAppFormTitle,expression:"dialogAppFormTitle=='应用发布详情'"}],attrs:{label:"创建时间",prop:"create_time"}},[a("el-date-picker",{attrs:{type:"datetime"},model:{value:t.appData.create_time,callback:function(e){t.$set(t.appData,"create_time",e)},expression:"appData.create_time"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"应用发布详情"==t.dialogAppFormTitle,expression:"dialogAppFormTitle=='应用发布详情'"}],attrs:{label:"最近一次更新时间",prop:"update_time"}},[a("el-date-picker",{attrs:{type:"datetime"},model:{value:t.appData.update_time,callback:function(e){t.$set(t.appData,"update_time",e)},expression:"appData.update_time"}})],1)],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:"编辑应用发布"==t.dialogAppFormTitle,expression:"dialogAppFormTitle=='编辑应用发布'"}],staticClass:"clone-app",attrs:{type:"primary"},on:{click:t.handleCloneApp}},[t._v("克 隆")]),t._v(" "),a("el-button",{on:{click:function(e){t.updateLoading=!1,t.addLoading=!1,t.dialogAppFormVisible=!1}}},[t._v("关闭")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"新增应用发布"==t.dialogAppFormTitle,expression:"dialogAppFormTitle=='新增应用发布'"}],attrs:{type:"primary",loading:t.addLoading},on:{click:t.handleAddApp}},[t._v("确 定")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"编辑应用发布"==t.dialogAppFormTitle,expression:"dialogAppFormTitle=='编辑应用发布'"}],attrs:{type:"primary",loading:t.updateLoading},on:{click:t.handleUpdateApp}},[t._v("更 新")])],1)]),t._v(" "),a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"delDialog",attrs:{visible:t.dialogDeleteAppVisible,title:"删除应用："+t.deleteAppData.app_name,width:"20%","close-on-press-escape":!1,"close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(e){t.dialogDeleteAppVisible=e}}},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("el-form",{attrs:{model:t.deleteAppData,"label-position":"top",size:"mini"}},[a("el-form-item",{staticClass:"is-required",attrs:{label:"是否要同时删除应用目录和应用备份目录:"}},[a("el-radio-group",{model:{value:t.deleteAppData.delete_app_file_select,callback:function(e){t.$set(t.deleteAppData,"delete_app_file_select",e)},expression:"deleteAppData.delete_app_file_select"}},[a("el-radio",{attrs:{label:"delete_app_file"}},[t._v("是")]),t._v(" "),a("el-radio",{attrs:{label:"no_delete_app_file"}},[t._v("否")])],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.deleteLoading=!1,t.dialogDeleteAppVisible=!1}}},[t._v("关闭")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.deleteLoading},on:{click:t.handleDeleteApp}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{staticClass:"logDialog",attrs:{visible:t.dialogLogVisible,width:"800px"},on:{"update:visible":function(e){t.dialogLogVisible=e}}},[a("span",{staticClass:"el-dialog__title",attrs:{slot:"title"},slot:"title"},[a("span",[t._v(t._s(t.logTitle+" 日志"))])]),t._v(" "),a("el-row",{staticStyle:{"padding-bottom":"10px",height:"35px","line-height":"35px"}},[a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[a("span",{staticStyle:{"font-weight":"bold"}},[t._v("发布时间：")]),a("span",[t._v(t._s(t._f("parseTime")(t.logTemp.create_time,"{y}-{m}-{d} {h}:{i}")))])]),t._v(" "),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[a("span",{staticStyle:{"font-weight":"bold"}},[t._v("发布结果：")]),a("span",[t._v(t._s(t.logTemp.release_result))])]),t._v(" "),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[a("span",{staticStyle:{"font-weight":"bold"}},[t._v("操作人：")]),a("span",[t._v(t._s(t.logTemp.username))])]),t._v(" "),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[a("el-button",{attrs:{size:"mini",type:"primary",loading:t.logLoading},on:{click:t.getLogList}},[t._v("刷新")])],1)],1),t._v(" "),a("el-row",[a("pre",{staticClass:"app-log-pre",domProps:{innerHTML:t._s(t.logTemp.log)}}),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.logTotal>0,expression:"logTotal>0"}],staticStyle:{margin:"0",padding:"10px 16px 10px 16px"},attrs:{total:t.logTotal,page:t.logListQuery.page,page_size:t.logListQuery.page_size,layout:"total, prev, pager, next, jumper"},on:{"update:page":function(e){return t.$set(t.logListQuery,"page",e)},"update:page_size":function(e){return t.$set(t.logListQuery,"page_size",e)},pagination:t.getLogList}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogLogVisible=!1}}},[t._v("确定")])],1)],1)],1)},n=[],s=(a("28a5"),a("5530")),r=(a("ac6a"),a("b85c")),o=(a("6b54"),a("4917"),a("5c83")),l=a("383f"),p=a("f52a"),c=a("6724"),u=(a("ed08"),a("333d")),d=a("5c96"),_={name:"ReleaseTable",components:{Pagination:u["a"]},directives:{elDragDialog:o["a"],waves:c["a"]},data:function(){var t=this,e=function(e,a,i){"linux"==t.appData.sys_type?a?i():i(new Error("请输入目录属主")):i()},a=function(e,a,i){-1!=t.appData.operation_list.indexOf("SVN更新")?a?i():i(new Error("不能为空")):i()},i=function(e,a,i){-1!=t.appData.operation_list.indexOf("GIT更新")?a?i():i(new Error("不能为空")):i()},n=function(e,a,i){-1!=t.appData.operation_list.indexOf("同步文件")?a?i():i(new Error("请选择")):i()},s=function(e,a,i){if(-1!=t.appData.operation_list.indexOf("同步文件"))if("rsync"==t.appData.sync_file_method){var n=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;a?null==a.match(n)?i(new Error("IP格式不合法")):i():i(new Error("IP不能为空"))}else i();else i()},r=function(e,a,i){if(-1!=t.appData.operation_list.indexOf("同步文件"))if("rsync"==t.appData.sync_file_method){var n=/^([0-9]|[1-9]\d{1,3}|[1-5]\d{4}|6[0-5]{2}[0-3][0-5])$/;a?null==a.match(n)?i(new Error("端口不合法")):i():i(new Error("IP不能为空"))}else i();else i()},o=function(e,a,i){-1!=t.appData.operation_list.indexOf("应用停止")?a?i():i(new Error("请选择停止方式")):i()},l=function(e,a,i){-1!=t.appData.operation_list.indexOf("应用停止")?a?i():i(new Error("不能为空")):i()},p=function(e,a,i){-1!=t.appData.operation_list.indexOf("应用启动")?a?i():i(new Error("请选择启动方式")):i()},c=function(e,a,i){-1!=t.appData.operation_list.indexOf("应用启动")?a?i():i(new Error("不能为空")):i()},u=function(e,a,i){-1!=t.appData.operation_list.indexOf("执行命令1")?a?i():i(new Error("不能为空")):i()},d=function(e,a,i){-1!=t.appData.operation_list.indexOf("执行命令2")?a?i():i(new Error("不能为空")):i()};return{appData:{app_name:"",sys_type:"linux",minion_list:[],app_path:"",app_path_owner:"root",app_svn_url:"",app_svn_user:"",app_svn_password:"",app_git_url:"",app_git_user:"",app_git_password:"",app_git_branch:"master",execution_style:"serial",operation_list:[],sync_file_check_diff:"not_check_file",sync_file_method:"rsync",rsync_ip:"",rsync_port:"",app_stop_style:"停止服务名",app_stop_cmd:"",app_start_style:"启动服务名",app_start_cmd:"",cmd1:"",cmd2:"",operation_arguments:"",app_backup_path:"",create_time:"",update_time:"",description:"",co_path:"",co_status:""},operation_list:[{key:"SVN更新",label:"SVN更新"},{key:"GIT更新",label:"GIT更新"},{key:"同步文件",label:"同步文件"},{key:"应用停止",label:"应用停止"},{key:"应用启动",label:"应用启动"},{key:"执行命令1",label:"执行命令1"},{key:"执行命令2",label:"执行命令2"}],operation_transfer_error:"",minion_transfer_error:"",app_name_error:"",dialogAppFormVisible:!1,minion_list:[],rules:{app_name:{required:!0,message:"请输入应用名称",trigger:"blur"},sys_type:{required:!0,message:"请选择系统类型",trigger:"change"},app_path:{required:!0,message:"请输入应用路径",trigger:"blur"},app_path_owner:{validator:e,trigger:"blur"},app_svn_url:{validator:a,trigger:"blur"},app_svn_user:{validator:a,trigger:"blur"},app_svn_password:{validator:a,trigger:"blur"},app_git_url:{validator:i,trigger:"blur"},app_git_user:{validator:i,trigger:"blur"},app_git_password:{validator:i,trigger:"blur"},app_git_branch:{validator:i,trigger:"blur"},execution_style:{required:!0,message:"请选择执行顺序",trigger:"change"},sync_file_check_diff:{validator:n,trigger:"change"},sync_file_method:{validator:n,trigger:"change"},rsync_ip:{validator:s,trigger:"blur"},rsync_port:{validator:r,trigger:"blur"},app_stop_style:{validator:o,trigger:"change"},app_stop_cmd:{validator:l,trigger:"blur"},app_start_style:{validator:p,trigger:"change"},app_start_cmd:{validator:c,trigger:"blur"},cmd1:{validator:u,trigger:"blur"},cmd2:{validator:d,trigger:"blur"}},listQuery:{page:1,page_size:10,app_name:"",minion_id:"",app_url:"",ordering:""},allLoading:!1,addLoading:!1,updateLoading:!1,deleteLoading:!1,tableKey:0,data_list:null,total:0,multipleSelection:[],listLoading:!0,dialogAppFormTitle:"新增应用发布",dialogDeleteAppVisible:!1,deleteAppData:{app_name:"",id:"",delete_app_file_select:"no_delete_app_file"},dialogInfoVisible:!1,infoTemp:{},dialogLogVisible:!1,logTemp:{},logListQuery:{page:1,page_size:1,app_name:""},logTotal:0,logTitle:"",logLoading:!1}},watch:{"appData.minion_list":{handler:function(t,e){t.length>0&&(this.minion_transfer_error="")}},"appData.operation_list":{handler:function(t,e){t.length>0&&(this.operation_transfer_error="")}}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.listLoading=!0,Object(p["j"])(this.listQuery).then((function(e){t.data_list=e.data.results,t.total=e.data.count,t.appData.rsync_ip=e.data.msg.rsync_ip,t.appData.rsync_port=e.data.msg.rsync_port,setTimeout((function(){t.listLoading=!1}),500)})).catch((function(e){t.listLoading=!1}))},getListNoloading:function(){var t=this;Object(p["j"])(this.listQuery).then((function(e){t.data_list=e.data.results,t.total=e.data.count}))},getLogList:function(){var t=this;this.logLoading=!0,Object(p["p"])(this.logListQuery).then((function(e){if(t.logTemp=e.data.results[0],t.logTotal=e.data.count,"[object Object]"===Object.prototype.toString.call(t.logTemp))if("[object Array]"===Object.prototype.toString.call(JSON.parse(t.logTemp["log_content"]))){t.logTemp.log="";var a,i=Object(r["a"])(JSON.parse(t.logTemp["log_content"]));try{for(i.s();!(a=i.n()).done;){var n=a.value;t.logTemp.log+=n}}catch(s){i.e(s)}finally{i.f()}}else t.logTemp.log="还未发布过";else t.logTemp={log:"还未发布过"};console.log(t.logTemp),t.logLoading=!1})).catch((function(e){console.log("应用日志查询"+e),t.logLoading=!1}))},getIdList:function(){var t=this;this.minion_list=[],this.appData.minion_list=[];var e={};e.sys=this.appData.sys_type,Object(l["m"])(e).then((function(e){var a=e.data.results;a.forEach((function(e,a){t.minion_list.push({label:e,key:e})}))})).catch((function(t){console.log("获取minion id字段列表"+t)}))},handleFilter:function(){this.listQuery.page=1,this.getList()},resetTemp:function(){this.minion_list=[],this.$refs["appDataForm"].resetFields()},handAddReleaseDailog:function(){var t=this;this.dialogAppFormTitle="新增应用发布",this.minion_transfer_error="",this.operation_transfer_error="",this.app_name_error="",this.dialogAppFormVisible=!0,this.$nextTick((function(){t.resetTemp(),t.getIdList(),t.$refs["app_name_focus"].focus(),t.$refs.dataTransfer.clearQuery("left"),t.$refs.dataTransfer.clearQuery("right"),t.$refs["appDataForm"].clearValidate()}))},handUpdateReleaseDailog:function(t){var e=this;this.dialogAppFormTitle="编辑应用发布";var a=Object(s["a"])({},t);this.minion_transfer_error="",this.operation_transfer_error="",this.app_name_error="",this.dialogAppFormVisible=!0,this.$nextTick((function(){for(var t in e.resetTemp(),a.minion_list=a.minion_list.split(","),a.operation_list=JSON.parse(a.operation_list),a.operation_arguments=JSON.parse(a.operation_arguments),a.operation_arguments)a[t]=a.operation_arguments[t];a.operation_arguments="",e.appData=a,e.appData.co_status=e.appData.co_status?"已检出":"未检出",e.$refs.dataTransfer.clearQuery("left"),e.$refs.dataTransfer.clearQuery("right"),e.$refs["appDataForm"].clearValidate();var i=e.appData.minion_list;e.appData.minion_list=[],e.minion_list=[];var n={};n.sys=e.appData.sys_type,Object(l["m"])(n).then((function(t){var a=t.data.results;a.forEach((function(t,a){e.minion_list.push({label:t,key:t})})),e.appData.minion_list=i})).catch((function(t){console.log("getMinionIdList"+t)}))}))},handAppInfoDailog:function(t){var e=this;this.dialogAppFormTitle="应用发布详情";var a=Object(s["a"])({},t);this.minion_transfer_error="",this.operation_transfer_error="",this.app_name_error="",this.dialogAppFormVisible=!0,this.$nextTick((function(){for(var t in e.resetTemp(),a.minion_list=a.minion_list.split(","),a.operation_list=JSON.parse(a.operation_list),a.operation_arguments=JSON.parse(a.operation_arguments),a.operation_arguments)a[t]=a.operation_arguments[t];a.operation_arguments="",e.appData=a,e.appData.co_status=e.appData.co_status?"已检出":"未检出",e.appData.create_time=new Date(e.appData.create_time),e.appData.update_time=new Date(e.appData.update_time),e.$refs.dataTransfer.clearQuery("left"),e.$refs.dataTransfer.clearQuery("right"),e.$refs["appDataForm"].clearValidate();var i=e.appData.minion_list;e.appData.minion_list=[],e.minion_list=[];var n={};n.sys=e.appData.sys_type,Object(l["m"])(n).then((function(t){var a=t.data.results;a.forEach((function(t,a){e.minion_list.push({label:t,key:t})})),e.appData.minion_list=i})).catch((function(t){console.log("getMinionIdList_1"+t)}))}))},handleAddApp:function(){var t=this;this.$refs["appDataForm"].validate((function(e){if(!e)return!1;var a=Object(s["a"])({},t.appData);return a.minion_list.length?(a.minion_list=a.minion_list.join(","),a.operation_list.length?(t.operation_transfer_error="",t.minion_transfer_error="",t.app_name_error="",t.addLoading=!0,console.log(a),void Object(p["a"])(a).then((function(e){if(e.data.status)t.addLoading=!1,t.dialogAppFormVisible=!1,d["Message"].success(e.data.results),t.getList();else{t.addLoading=!1;var a=e.data.results;if(console.log(JSON.stringify(a)),"[object Object]"===Object.prototype.toString.call(a))for(var i in a)t["".concat(i,"_error")]=a[i][0];else d["Message"].error(e.data.results)}})).catch((function(e){t.addLoading=!1}))):(t.operation_transfer_error="请选择操作",!1)):(t.minion_transfer_error="请至少选择一个Minion ID",!1)}))},handleUpdateApp:function(){var t=this;this.$refs["appDataForm"].validate((function(e){if(!e)return!1;var a=Object(s["a"])({},t.appData);return a.minion_list.length?(a.minion_list=a.minion_list.join(","),a.operation_list.length?(a.co_status="已检出"==a.co_status,t.operation_transfer_error="",t.minion_transfer_error="",t.app_name_error="",void t.$confirm("确定要更新当前应用?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.updateLoading=!0,Object(p["r"])(a).then((function(e){if(e.data.status)t.updateLoading=!1,t.dialogAppFormVisible=!1,d["Message"].success(e.data.results),t.getList();else{t.updateLoading=!1;var a=e.data.results;if(console.log(JSON.stringify(a)),"[object Object]"===Object.prototype.toString.call(a))for(var i in a)t["".concat(i,"_error")]=a[i][0];else d["Message"].error(e.data.results)}})).catch((function(e){t.updateLoading=!1}))})).catch((function(){t.$message({type:"info",message:"已取消更新"})}))):(t.operation_transfer_error="请选择操作",!1)):(t.minion_transfer_error="请至少选择一个Minion ID",!1)}))},handleCloneApp:function(){this.dialogAppFormTitle="新增应用发布",this.app_name_error="该字段必须唯一",this.$refs["app_name_focus"].focus()},handDeleteAppDailog:function(t){this.dialogDeleteAppVisible=!0,this.deleteAppData.app_name=t.app_name,this.deleteAppData.id=t.id,this.deleteAppData.delete_app_file_select="no_delete_app_file"},handleDeleteApp:function(){var t=this,e={};e.id=this.deleteAppData.id,e.delete_app_file_select=this.deleteAppData.delete_app_file_select,this.deleteLoading=!0,Object(p["g"])(e).then((function(e){e.data.status?(t.deleteLoading=!1,t.dialogDeleteAppVisible=!1,d["Message"].success(e.data.results),t.getList()):(t.deleteLoading=!1,d["Message"].error(e.data.results))})).catch((function(e){t.deleteLoading=!1}))},GoRelease:function(t,e){var a=this,i={};i["id"]=e.id,i["release_version"]=t||"HEAD",e.release_status="发布中",Object(p["q"])(i).then((function(t){t.data.status?e.release_status="发布成功":"发布中"===t.data.release_status?(a.$message({type:"error",message:t.data.results}),e.release_status="发布中"):(console.log(t.data.results),e.release_status="发布失败")})).catch((function(t){e.release_status="空闲"}))},handGoRelease:function(t){var e=this;this.$prompt("<strong>请输入SVN/GIT版本号,为空则默认为最新</strong>","版本号 填写",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"SVN/GIT版本号",dangerouslyUseHTMLString:!0}).then((function(a){var i=a.value;e.GoRelease(i,t)})).catch((function(){e.$message({type:"info",message:"取消发布"})}))},handleSelectionChange:function(t){this.multipleSelection=t},handGoReleaseList:function(){var t=this;0===this.multipleSelection.length?d["Message"].error("未选择任何记录，请选择后重试"):this.$prompt("<strong>请输入SVN/GIT版本号,为空则默认为最新</strong>","版本号 填写",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"SVN/GIT版本号",dangerouslyUseHTMLString:!0}).then((function(e){var a,i=e.value,n=Object(r["a"])(t.multipleSelection);try{for(n.s();!(a=n.n()).done;){var s=a.value;t.GoRelease(i,s)}}catch(o){n.e(o)}finally{n.f()}})).catch((function(){t.$message({type:"info",message:"取消发布"})}))},handleSingleRelease:function(t,e){var a=this;"SVN更新"===e||"GIT更新"===e?this.$prompt("<strong>应用：".concat(t.app_name,"</strong><br><strong>操作：").concat(e,"</strong>"),"单项操作",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"SVN/GIT版本号,为空则默认为最新",dangerouslyUseHTMLString:!0}).then((function(i){var n=i.value,s={};s["id"]=t.id,s["release_version"]=n||"HEAD",s["single_cmd"]=e,t.release_status="发布中",Object(p["q"])(s).then((function(e){e.data.status?t.release_status="发布成功":"发布中"===e.data.release_status?(a.$message({type:"error",message:e.data.results}),t.release_status="发布中"):(console.log(e.data.results),t.release_status="发布失败")})).catch((function(t){console.log("单项操作发布"+t)}))})).catch((function(){a.$message({type:"info",message:"取消发布"})})):this.$confirm("<strong>应用：".concat(t.app_name,"</strong><br><strong>操作：").concat(e,"</strong>"),"单项操作",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){var i={};i["id"]=t.id,i["single_cmd"]=e,t.release_status="发布中",Object(p["q"])(i).then((function(e){e.data.status?t.release_status="发布成功":"发布中"===e.data.release_status?(a.$message({type:"error",message:e.data.results}),t.release_status="发布中"):(console.log(e.data.results),t.release_status="发布失败")})).catch((function(t){console.log("单项操作发布_1"+t)}))})).catch((function(){a.$message({type:"info",message:"取消发布"})}))},sortChange:function(t){var e=t.prop,a=t.order;"app_name"===e?this.listQuery.ordering="ascending"===a?"app_name":"-app_name":"minion_id"===e&&(this.listQuery.ordering="ascending"===a?"minion_id":"-minion_id"),this.handleFilter()},handAppLogDailog:function(t){this.logListQuery.page=1,this.logListQuery.app_name=t.app_name,this.logTitle=t.app_name,this.logTemp.log="",this.getLogList(),this.dialogLogVisible=!0}}},m=_,f=(a("ce3a"),a("2877")),g=Object(f["a"])(m,i,n,!1,null,"839dcfa6",null);e["default"]=g.exports},f52a:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"j",(function(){return s})),a.d(e,"r",(function(){return r})),a.d(e,"q",(function(){return o})),a.d(e,"g",(function(){return l})),a.d(e,"p",(function(){return p})),a.d(e,"i",(function(){return c})),a.d(e,"h",(function(){return u})),a.d(e,"k",(function(){return d})),a.d(e,"m",(function(){return _})),a.d(e,"o",(function(){return m})),a.d(e,"l",(function(){return f})),a.d(e,"n",(function(){return g})),a.d(e,"d",(function(){return h})),a.d(e,"e",(function(){return v})),a.d(e,"b",(function(){return b})),a.d(e,"f",(function(){return y})),a.d(e,"c",(function(){return w}));var i=a("b775");function n(t){return Object(i["a"])({url:"/release/release-base/",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/release/release-base/",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/release/release-base/".concat(t.id,"/"),method:"patch",data:t})}function o(t){return Object(i["a"])({url:"/release/release-opt/",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/release/release-del/",method:"post",data:t})}function p(t){return Object(i["a"])({url:"/release/release-log/",method:"get",params:t})}function c(){return Object(i["a"])({url:"/release/release-base/1/",method:"get"})}function u(){return Object(i["a"])({url:"/release-group/1/",method:"get"})}function d(t){return Object(i["a"])({url:"/release-group/",method:"post",data:t})}function _(t){return Object(i["a"])({url:"/release-group/",method:"get",params:t})}function m(t){return Object(i["a"])({url:"/release-group/".concat(t.id,"/"),method:"patch",data:t})}function f(t){return Object(i["a"])({url:"/release-group/".concat(t,"/"),method:"delete"})}function g(t){return Object(i["a"])({url:"/release-member/",method:"get",params:t})}function h(t){return Object(i["a"])({url:"/release-auth/",method:"get",params:t})}function v(){return Object(i["a"])({url:"/release-auth/1/",method:"get"})}function b(t){return Object(i["a"])({url:"/release-auth/",method:"post",data:t})}function y(t){return Object(i["a"])({url:"/release-auth/".concat(t.id,"/"),method:"patch",data:t})}function w(t){return Object(i["a"])({url:"/release-auth/".concat(t,"/"),method:"delete"})}}}]);